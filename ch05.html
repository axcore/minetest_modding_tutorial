<!doctype html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<style type="text/css">
td, th { border: 1px solid #c3c3c3; padding: 0 3px 0 3px; }
table { border-collapse: collapse; }
img { max-width: 100%; }
</style>
<meta name="generator" content="ReText 7.1.0">
<title>ch05</title>
<style type="text/css">
</style>
</head>
<body>
<p><a href="ch04.html">Previous</a> <a href="index.html">Index</a> <a href="ch06.html">Next</a></p>
<hr>
<h1>5 Craftitems</h1>
<p>Craftitems are things you can hold but not place on the ground. You have probably picked apples from a tree, and picked blueberries from a bush. Apples and blueberries are both craftitems.</p>
<hr>
<p>Creating new craftitems is simple. Let's create a chocolate bar that you can eat. As before, create your own image, or use this one:</p>
<p><img alt="Chocolate bar" src="img/ch05/chocolate.png"></p>
<p>This image contains transparent pixels, so that the chocolate bar has the right shape. If you're not sure how that is done in your graphics application, either search for help, or just use a normal square image.</p>
<p>Copy the image into your mod's <strong>textures</strong> folder before continuing.</p>
<hr>
<p>We start with another new function that receives two pieces of data.</p>
<pre><code>    minetest.register_craftitem(NAME, TABLE)
</code></pre>
<p>A good name for your craftitem would be <strong>hello:chocolate</strong>, so let's add that, and split the table across separate lines.</p>
<pre><code>    minetest.register_craftitem("hello:chocolate", {
        STUFF
        GOES
        HERE
    })
</code></pre>
<p>For craftitems, the table almost always contains a <strong>description</strong> and an <strong>inventory_image</strong>. The craftitem is flat, so only one image is needed; we don't have to think about lists.</p>
<pre><code>    minetest.register_craftitem("hello:chocolate", {
        description = "Delicious Chocolate Bar",
        inventory_image = "chocolate.png",
    })
</code></pre>
<hr>
<p>Now, let's talk about <strong>signals</strong>.</p>
<p>Much of your Lua code sits around, doing nothing, until it's actually needed. When you hold the chocolate bar and left-click, Minetest sends a <strong>signal</strong> to the mod's code. The code can ignore the signal, or it can do something in response.</p>
<p>In this case, when the signal is received, we want to eat the chocolate bar. Eating something normally reduces the player's hunger, and might also improve their health.</p>
<p>To do that, we add a new line to the table, in the following format:</p>
<pre><code>    on_use = FUNCTION,
</code></pre>
<p>When the code receives the signal, it checks to see whether <strong>on_use</strong> exists in the table. If so, the function is called (and something happens). If not, nothing happens.</p>
<p>Here is the complete code, which you can add to your <strong>init.lua</strong>.</p>
<pre><code>    minetest.register_craftitem("hello:chocolate", {
        description = "Delicious Chocolate Bar",
        inventory_image = "chocolate.png",
        on_use = minetest.item_eat(2),
    })
</code></pre>
<p>Whenever you want to create something edible, just copy and paste the <strong>on_use</strong> line. If you like, you can change the number: 1 will have very little effect on your player's hunger, but 5 would have a dramatic effect.</p>
<p>Since this is a chocolate bar, and not something healthy, you might try using a negative number. Modify the code and see what happens!</p>
<hr>
<p><a href="ch04.html">Previous</a> <a href="index.html">Index</a> <a href="ch06.html">Next</a></p>

</body>
</html>
